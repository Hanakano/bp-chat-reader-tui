# Botpress Conversation Fetcher

This script fetches conversation transcripts from the Botpress Cloud API, filters them to include only conversations containing at least one message from a user (direction: "incoming"), and saves the relevant data incrementally to a JSON Lines (`.jsonl`) file.

The incremental saving means that if the script is interrupted, the conversations already fetched and processed will be present in the output file.

## Prerequisites

1.  **Python 3:** Ensure you have Python 3.6 or later installed.
2.  **Required Python Packages:**
    *   `tqdm`: Used for displaying progress bars. Install using pip:
        ```bash
        pip install tqdm
        ```
3.  **Environment Variables:** The script requires the following environment variables to be set to authenticate with the Botpress API:
    *   `BOTPRESS_WORKSPACE_ID`: Your Botpress workspace ID.
    *   `BOTPRESS_BOT_ID`: The ID of the specific bot whose conversations you want to fetch.
    *   `BOTPRESS_TOKEN`: A Botpress API token with permissions to read conversations and messages. You can generate this in your Botpress Cloud admin panel.

    You can set these variables in your shell before running the script, for example:
    ```bash
    export BOTPRESS_WORKSPACE_ID="your_workspace_id"
    export BOTPRESS_BOT_ID="your_bot_id"
    export BOTPRESS_TOKEN="your_api_token"
    python src/fetchMessages.py
    ```
    Or use a tool like `direnv` or include them in your execution environment.

## Usage

Run the script from your terminal using `python`.

```bash
python src/fetchMessages.py [OPTIONS]
python src/fetchMessages.py -l 100 -c 20 -o data/bot_chat_output.jsonl
```

# Botpress Conversation Viewer

This is a cool TUI visualizer for chat transcripts generated by the above scripts. Run it with:

```bash
python src/viewChats.py --file data/bot_chat_output.json
```

## Keyboard Shortcuts:

* `n/l - next chat`
* `h/p - previous chat`
* `down/j - scroll down`
* `up/k - scroll up`
* `g - go to top`
* `G - go to bottom`
* `y - copy conversation Id to clipboard`
* `t - copy chat JSON to clipboard`
